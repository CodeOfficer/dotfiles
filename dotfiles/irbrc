require 'rubygems'
require 'irb/completion'
require 'what_methods'
require 'pp' # in ruby-debug

# taken from http://blog.nicksieger.com/articles/2006/04/23/tweaking-irb
  ARGV.concat [ "--readline", "--prompt-mode", "simple" ]

  module Readline
    module History
      LOG = "~/.irb-history"

      def self.write_log(line)
        File.open(LOG, 'ab') {|f| f << "#{line}\n"}
      end

      def self.start_session_log
        write_log("# session start: #{Time.now}")
        at_exit { write_log("# session stop: #{Time.now}\n") }
      end
    end

    alias :old_readline :readline
    def readline(*args)
      ln = old_readline(*args)
      begin
        History.write_log(ln)
      rescue
      end
      ln
    end
  end

  Readline::History.start_session_log

  require 'irb/ext/save-history'
  IRB.conf[:SAVE_HISTORY] = 100
  IRB.conf[:HISTORY_FILE] = "~/.irb-save-history"
# end take

if ENV['RAILS_ENV']
  load File.dirname(__FILE__) + '~/bin/dotfiles/railsrc'
end